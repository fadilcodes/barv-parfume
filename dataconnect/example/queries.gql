query AllPerfumes @auth(level: PUBLIC, insecureReason: "This operation is safe to expose to the public as it only retrieves public perfume data.") {
  perfumes {
    id
    name
    brand
    imageUrl
    scentFamily
    topNotes
    heartNotes
    baseNotes
    description
  }
}

query UserLists @auth(level: USER) {
  lists(where: {userId: {eq_expr: "auth.uid"}}) {
    id
    name
    description
    isPublic
    createdAt
    updatedAt
  }
}

mutation CreateReview($perfumeId: UUID!, $rating: Int!, $reviewText: String, $isPublic: Boolean!) @auth(level: USER) {
  review_insert(data: {
    perfumeId: $perfumeId,
    userId_expr: "auth.uid",
    rating: $rating,
    reviewText: $reviewText,
    isPublic: $isPublic,
    createdAt_expr: "request.time",
    updatedAt_expr: "request.time"
  })
}

mutation UpdateUserProfile($displayName: String!, $bio: String, $photoUrl: String) @auth(level: USER) {
  user_update(
    key: {id_expr: "auth.uid"},
    data: {
      displayName: $displayName,
      bio: $bio,
      photoUrl: $photoUrl
    }
  )
}